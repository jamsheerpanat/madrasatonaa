- Product name: madrasatonaa
- Description: Next-generation School Management System (Web-first MVP)
- Market: Kuwait + GCC
- Business model: One-time license + AMC
- Installation model: Single school per installation

### 6. Timeline-First UI
(See `apps/web/app/app/timeline`)
- The primary interface for all users is the "Timeline".
- It aggregates events from all subsystems based on the user's role.
- Filtering by: Event Type, Child (Parent only), Branch (Staff only).
- Visual cards with icons and distinct colors for scopes (Branch/Section/Student).

### 7. Principal Rhythm Dashboard
(See `apps/web/app/app/principal/dashboard`)
- A specialized dashboard for School Leaders (Principal, VP, HOD).
- Focuses on "Rhythm": Is the school operating correctly today?
- Key Metrics (Placeholder in V1):
  - Attendance Completion Status per section.
  - Pending Acknowledgements.
  - Upcoming administrative deadlines.

### 8. Timetable Module
(See `apps/web/app/app/timetable`)
- **Structure**: Period Templates (e.g., 8 periods) defined per branch.
- **Assignment**: Matrix of Day x Period -> (Subject, Teacher, Room).
- **Viewing**:
  - Staff: View "My Timetable" (autogenerated from assignments).
  - Parent: View "My Child's Timetable".
  - Admin: View/Manage any section's timetable.
- **Events**: Updates trigger `TimetableUpdated` timeline events.

### 9. Attendance Module
(See `apps/web/app/app/attendance`)
- **Workflow**:
  - Daily sheets auto-created upon first access/view.
  - Default status: `DRAFT`. All students `PRESENT`.
  - Teachers mark `ABSENT` / `LATE` / `EARLY_LEAVE` and can add notes.
  - Submission locks the day and emits timeline events.
- **Parent Interaction**:
  - View child's monthly record.
  - Submit justification for absences (Text initially, Attachment placeholder).
- **Integration**:
  - Timeline events: `AttendanceSubmitted` (Section scope), `AttendanceJustified` (Student scope).
  - Principal Rhythm: Tracks % of sections submitted by 9:00 AM (conceptually).

### 10. Announcements & Memos (Broadcasts)
- **Announcements**: One-way communication.
- **Memos**: Compliance communication requiring explicit Acknowledgement.
- **Scope**: JSON-based targeting (`audience`, `branch_ids`, `section_ids`, `student_ids`).
- **Scheduling**: `publish_at` field supported by `broadcasts:publish` scheduler command.
- **Timeline**: Events emitted on publish (Section/Branch scope) and Ack (Student scope).

### 11. Assignments Modules
- **Assignments**: Teachers create Homework/Classwork for sections.
- **Submissions**: Students (via Parents) submit text or files.
- **Grading**: Teachers grade submissions and provide feedback.
- **Timeline**: Events emitted on Post, Submit, and Grade.

### 11. Assignments Modules
- **Assignments**: Teachers create Homework/Classwork for sections.
- **Submissions**: Students (via Parents) submit text or files.
- **Grading**: Teachers grade submissions and provide feedback.
- **Timeline**: Events emitted on Post, Submit, and Grade.

### 12. Exams & Report Cards
- **Terms**: Define academic periods (Term 1, Term 2, etc.).
- **Exams**: Scheduled by HOD/Admin.
- **Marks**: Teachers enter marks (Grade Letters) per student.
- **Results**: Published on `publish_at` date. Parents view only after publication.
- **Results**: Published on `publish_at` date. Parents view only after publication.
- **Report Cards**: Auto-generated HTML snapshots (PDF Phase 4).

### 13. Parent Requests (Tickets)
- **Categories**: Managed by Admin (Seeded: Meeting, Pickup, Document, etc.).
- **Workflow**: Parent creates -> Staff replies/resolves -> Parent acknowledges.
- **Privacy**: Parents isolated to only their tickets.
- **Privacy**: Parents isolated to only their tickets.
- **Notifications**: Staff notified on creation; Parent notified on reply/resolve.

### 14. File Storage (v0.13.0)
- **Engine**: S3-compatible (Filesystem abstraction).
- **Security**: Private by default. Signed URLs for access.
- **Access Policy**: Enforced at application layer (RBAC + Entity Linking).
- **Flow**: Direct client upload (signed URL) -> Finalize -> Link.

### 15. Notification Engine (v0.15.0)
- **Channels**: Email (Active), SMS (Hook, Quiet Hours), Push (Stub).
- **Templates**: Localized (EN/AR) templates for Memo, Assignment, Results, Ticket.
- **Rules**: Quiet Hours (21:00-07:00) skips SMS/Push.
- **Integration**: Events triggered by Domain Services.

## Data Models
(See `docs/API_CONTRACT.md` and `docs/EVENT_TIMELINE_MODEL.md`)

- Database model: One database per school
- Multi-branch: Supported inside same database
- Users:
  - Office (Admin modules)
  - Principal / Vice Principal
  - HOD
  - Teacher / Substitute
  - Counselor
  - Accountant
  - Reception
  - Student
  - Parent
- Core differentiators:
  - Timeline-first experience
  - Ultra-fast daily operations

## Academic Structure
- **Branch**: Top-level entity (e.g., Main Branch).
- **Grade**: Linked to Branch (e.g., Grade 1).
- **Section**: Linked to Grade (e.g., Grade 1-A).
- **Subject**: Linked to Branch (e.g., Math).
- **Academic Year**: Global setting (e.g., 2025-2026).

- V1 Modules:
  - Timetable (customizable periods)
  - Attendance (daily + parent justification)
  - Assignments & submissions
  - Exams, grades, report cards
  - Announcements & memos (acknowledgement)
  - Parent requests (ticket-based)
  - Audit logs
  - Import / Export
  - Backup & restore UI
- Excluded from V1:
  - Fees
  - Transport
  - Hardware integrations
- Language:
  - English + Arabic (RTL UI in V2)
- Platforms:
  - Web only for V1
  - Native mobile apps (Teacher/Parent/Student) in V2 using same APIs
